<!DOCTYPE html>
<html>
<head>
  <title>前后端通信</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <h5>您的账户余额为<span id="amount">&&&amount&&&</span></h5>
  <button id="button">付款￥1</button>
  <script src="https://cdn.bootcss.com/jquery/3.3.1/core.js"></script>
  <script>
    button.addEventListener('click',(e)=>{
     let script = document.createElement('script')
     let functionName = 'sage'+parseInt(Math.random()*10000,10) //随机的函数名
     window[functionName]=function(result){
      if(result==='success'){
        amount.innerText = amount.innerText - 1
      }else{}
     }


     script.src = 'http://linda.com:8002/pay?callback=' + functionName
     document.body.appendChild(script)
     script.onload = function(e){
       e.currentTarget.remove()
       delete window[functionName]
     }
     script.onerror = function(){
       alert('fail')
       e.currentTarget.remove()
       delete window[functionName]
     } 
    })

/*
$.ajax({
 url:"",
 dataType:"",
 success:function(response){
  if(response==='success'){
   amount.innerText = amount.innerText
  }
 }
})
*/


  </script>
</body>
</html>
